<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using eisaR for Exon-Intron Split Analysis (EISA) • eisaR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using eisaR for Exon-Intron Split Analysis (EISA)">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eisaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eisaR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/eisaR.html">eisaR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fmicompbio/eisaR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Using eisaR for Exon-Intron Split Analysis (EISA)</h1>
                        <h4 class="author">Michael Stadler</h4>
            
            <h4 class="date">2020-02-18</h4>
      
      
      <div class="hidden name"><code>eisaR.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Exon-Intron Split Analysis has been described in <span class="citation">(Gaidatzis et al. 2015)</span>. It consists of separately quantifying exonic and intronic alignments in RNA-seq data, in order to measure changes in mature RNA and pre-mRNA reads across different experimental conditions. We have shown that this allows quantification of transcriptional and post-transcriptional regulation of gene expression.</p>
<p>The <code>eisaR</code> package contains convenience functions to facilitate the steps in an exon-intron split analysis, which consists of:<br>
1. preparing the annotation (exonic and gene body coordinate ranges)<br>
2. quantifying RNA-seq alignments in exons and introns<br>
3. calculating and comparing exonic and intronic changes across conditions<br>
4. visualizing the results</p>
<p>For the steps 1. and 2. above, this vignette makes use of Bioconductor annotation and the <em><a href="https://bioconductor.org/packages/3.11/QuasR">QuasR</a></em> package. It is also possible to obtain count tables for exons and introns using some other pipeline or approach, and directly start with step 3.</p>
</div>
<div id="annotation" class="section level1">
<h1 class="hasAnchor">
<a href="#annotation" class="anchor"></a>Preparing the annotation</h1>
<p>As mentioned, <code>eisaR</code> uses gene annotations from Bioconductor. They are provided in the form of <code>TxDb</code> objects, e.g. via packages such as <em><a href="https://bioconductor.org/packages/3.11/TxDb.Mmusculus.UCSC.mm10.knownGene">TxDb.Mmusculus.UCSC.mm10.knownGene</a></em>. You can see available annotations using the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">pkgs &lt;-<span class="st"> </span>BiocManager<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/available.html">available</a></span>(<span class="st">"TxDb"</span>)</a></code></pre></div>
<p>If you would like to use an alternative source of gene annotations, you might still be able to use <code>eisaR</code> by first converting your annotations into a <code>TxDb</code> (see <code>makeTxDb</code> in the <em><a href="https://bioconductor.org/packages/3.11/GenomicFeatures">GenomicFeatures</a></em> package).</p>
<p>For this example, <code>eisaR</code> contains a small <code>TxDb</code> to illustrate how regions are extracted. We will load it from a file. Alternatively, the object would be loaded using <code><a href="https://rdrr.io/r/base/library.html">library(...)</a></code>, for example using <code><a href="https://rdrr.io/r/base/library.html">library(TxDb.Mmusculus.UCSC.mm10.knownGene)</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># load package</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(eisaR)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># get TxDb object</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">txdbFile &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"hg19sub.sqlite"</span>, <span class="dt">package =</span> <span class="st">"eisaR"</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">txdb &lt;-<span class="st"> </span>AnnotationDbi<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">loadDb</a></span>(txdbFile)</a></code></pre></div>
<p>Exon and gene body regions are then extracted from the <code>TxDb</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># extract filtered exonic and gene body regions</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">regS &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getRegionsFromTxDb.html">getRegionsFromTxDb</a></span>(<span class="dt">txdb =</span> txdb, <span class="dt">strandedData =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; extracting exon coordinates</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; total number of genes/exons: 12/32</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; removing overlapping/single-exon/ambiguous genes (8)</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; creating filtered regions for 4 genes (33.3%) with 20 exons (62.5%)</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">regU &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getRegionsFromTxDb.html">getRegionsFromTxDb</a></span>(<span class="dt">txdb =</span> txdb, <span class="dt">strandedData =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; extracting exon coordinates</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; total number of genes/exons: 12/32</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; removing overlapping/single-exon/ambiguous genes (9)</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; creating filtered regions for 3 genes (25%) with 17 exons (53.1%)</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(regS)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;      exons genebodies </span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;         20          4</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(regU)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;      exons genebodies </span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;         17          3</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">regS<span class="op">$</span>exons</a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; GRanges object with 20 ranges and 0 metadata columns:</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;                   seqnames      ranges strand</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt;                      &lt;Rle&gt;   &lt;IRanges&gt;  &lt;Rle&gt;</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt;   ENSG00000078808     chr1 17278-18194      -</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt;   ENSG00000078808     chr1 18828-21741      -</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt;   ENSG00000078808     chr1 23614-23747      -</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt;   ENSG00000078808     chr1 24202-24358      -</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt;   ENSG00000078808     chr1 27799-27854      -</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt;               ...      ...         ...    ...</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt;   ENSG00000186891     chr1   5740-6070      -</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt;   ENSG00000186891     chr1   6755-7081      -</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt;   ENSG00000254999     chr3   2266-2513      +</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt;   ENSG00000254999     chr3 12300-12402      +</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt;   ENSG00000254999     chr3 12943-13884      +</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt;   -------</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt;   seqinfo: 3 sequences from an unspecified genome</span></a></code></pre></div>
<p>As you can see, the filtering procedure removes slightly more genes for unstranded data (<code>strandedData = FALSE</code>), as overlapping genes cannot be discriminated even if they reside on opposite strands.</p>
<p>You can also export the obtained regions into files. This may be useful if you plan to align and/or quantify reads outside of R. For example, you can use <em><a href="https://bioconductor.org/packages/3.11/rtracklayer">rtracklayer</a></em> to export the regions in <code>regS</code> into <code>.gtf</code> files:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(rtracklayer)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/pkg/rtracklayer/man/export.html">export</a></span>(regS<span class="op">$</span>exons, <span class="st">"hg19sub_exons_stranded.gtf"</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/pkg/rtracklayer/man/export.html">export</a></span>(regS<span class="op">$</span>genebodies, <span class="st">"hg19sub_genebodies_stranded.gtf"</span>)</a></code></pre></div>
</div>
<div id="quantify-rna-seq-alignments-in-exons-and-introns" class="section level1">
<h1 class="hasAnchor">
<a href="#quantify-rna-seq-alignments-in-exons-and-introns" class="anchor"></a>Quantify RNA-seq alignments in exons and introns</h1>
<p>For this example we will use the <em><a href="https://bioconductor.org/packages/3.11/QuasR">QuasR</a></em> package for indexing and alignment of short reads, and a small RNA-seq dataset that is contained in that package. As mentioned, it is also possible to align or also quantify your reads using an alternative aligner/counter, and skip over these steps.</p>
<div id="align" class="section level2">
<h2 class="hasAnchor">
<a href="#align" class="anchor"></a>Align reads</h2>
<p>Let’s first copy the sample data from the <em><a href="https://bioconductor.org/packages/3.11/QuasR">QuasR</a></em> package to the current working directory, all contained in a folder named <code>extdata</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(QuasR)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; Loading required package: Rbowtie</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="dt">package =</span> <span class="st">"QuasR"</span>, <span class="st">"extdata"</span>), <span class="st">"."</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>We next align the reads to a mini-genome (fasta file <code>extdata/hg19sub.fa</code>) using <code>qAlign</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">sampleFile &lt;-<span class="st"> "extdata/samples_chip_single.txt"</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">genomeFile &lt;-<span class="st"> "extdata/hg19sub.fa"</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">proj &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/QuasR/man/qAlign.html">qAlign</a></span>(<span class="dt">sampleFile =</span> <span class="st">"extdata/samples_rna_single.txt"</span>, </a>
<a class="sourceLine" id="cb6-5" data-line-number="5">               <span class="dt">genome =</span> <span class="st">"extdata/hg19sub.fa"</span>,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">               <span class="dt">aligner =</span> <span class="st">"Rhisat2"</span>, <span class="dt">splicedAlignment =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; Creating .fai file for: /home/travis/build/fmicompbio/eisaR/vignettes/extdata/hg19sub.fa</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; alignment files missing - need to:</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;     create alignment index for the genome</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;     create 4 genomic alignment(s)</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; Creating an Rhisat2 index for /home/travis/build/fmicompbio/eisaR/vignettes/extdata/hg19sub.fa</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; Finished creating index</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; Testing the compute nodes...OK</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; Loading QuasR on the compute nodes...OK</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; Available cores:</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; travis-job-1d4ec76e-0b93-46cc-bd8e-d600b2b7a633: 1</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; Performing genomic alignments for 4 samples. See progress in the log file:</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; /home/travis/build/fmicompbio/eisaR/vignettes/QuasR_log_583831d7c53f.txt</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; Genomic alignments have been created successfully</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="kw"><a href="https://rdrr.io/pkg/QuasR/man/alignmentStats.html">alignmentStats</a></span>(proj)</a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt;                seqlength mapped unmapped</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; Sample1:genome     95000   5961       43</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; Sample2:genome     95000   5914       86</span></a></code></pre></div>
</div>
<div id="count" class="section level2">
<h2 class="hasAnchor">
<a href="#count" class="anchor"></a>Count alignments in exons and gene bodies</h2>
<p>Alignments in exons and gene bodies can now be counted using <code>qCount</code> and the <code>regU</code> that we have generated earlier (assuming that the data is unstranded). Intronic counts can then be obtained from the difference between gene bodies and exons:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">cntEx &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/QuasR/man/qCount.html">qCount</a></span>(proj, regU<span class="op">$</span>exons, <span class="dt">orientation =</span> <span class="st">"any"</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; counting alignments...done</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; collapsing counts by sample...done</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; collapsing counts by query name...done</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">cntGb &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/QuasR/man/qCount.html">qCount</a></span>(proj, regU<span class="op">$</span>genebodies, <span class="dt">orientation =</span> <span class="st">"any"</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; counting alignments...done</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; collapsing counts by sample...done</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">cntIn &lt;-<span class="st"> </span>cntGb <span class="op">-</span><span class="st"> </span>cntEx</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(cntEx)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;                 width Sample1 Sample2</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; ENSG00000078808  4837     705    1065</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; ENSG00000186827  1821      37       8</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; ENSG00000186891  1470      26       2</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(cntIn)</a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt;                 width Sample1 Sample2</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; ENSG00000078808 10307       5      15</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; ENSG00000186827  1012       3       0</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; ENSG00000186891  1734       3       0</span></a></code></pre></div>
<p>As mentioned, both alignments and counts can also be obtained using alternative approaches. It is required that the two resulting exon and intron count tables have identical structure (genes in rows, samples in columns, the same order of rows and columns in both tables).</p>
</div>
<div id="load-full-count-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#load-full-count-tables" class="anchor"></a>Load full count tables</h2>
<p>The above example only contains very few genes. For the rest of the vignette, we will use count tables from a real RNA-seq experiment that are provided in the <code>eisaR</code> package. The counts correspond to the rawdata used in Figure 3a of <span class="citation">(Gaidatzis et al. 2015)</span> and are also available online from the <a href="https://fmicompbio.github.io/projects/EISA/EISA.html">supplementary material</a>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">cntEx &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>,</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                             <span class="st">"Fig3abc_GSE33252_rawcounts_exonic.rds"</span>,</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">                             <span class="dt">package =</span> <span class="st">"eisaR"</span>))</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">cntIn &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                             <span class="st">"Fig3abc_GSE33252_rawcounts_intronic.rds"</span>,</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                             <span class="dt">package =</span> <span class="st">"eisaR"</span>))</a></code></pre></div>
</div>
</div>
<div id="convenient" class="section level1">
<h1 class="hasAnchor">
<a href="#convenient" class="anchor"></a>Run EISA conveniently</h1>
<p>All the further steps in exon-intron split analysis can now be performed using a single function <code>runEISA</code>. If you prefer to perform the analysis step-by-step, you can skip now to section @ref(stepwise).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># remove "width" column</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">Rex &lt;-<span class="st"> </span>cntEx[, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(cntEx) <span class="op">!=</span><span class="st"> "width"</span>]</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">Rin &lt;-<span class="st"> </span>cntIn[, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(cntIn) <span class="op">!=</span><span class="st"> "width"</span>]</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co"># create condition factor (contrast will be TN - ES)</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">cond &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ES"</span>, <span class="st">"ES"</span>, <span class="st">"TN"</span>, <span class="st">"TN"</span>))</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co"># run EISA</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runEISA.html">runEISA</a></span>(Rex, Rin, cond)</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; filtering quantifyable genes...keeping 11034 from 20288 (54.4%)</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; fitting statistical model...done</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; calculating contrasts...done</span></a></code></pre></div>
<div id="alternative-implementations-of-eisa" class="section level2">
<h2 class="hasAnchor">
<a href="#alternative-implementations-of-eisa" class="anchor"></a>Alternative implementations of EISA</h2>
<p>There are five arguments in <code>runEISA</code> (<code>modelSamples</code>, <code>geneSelection</code>, <code>effects</code>, <code>statFramework</code> and <code>pscnt</code>) that control gene filtering, calculation of contrasts and the statistical method used, summarized in the bullet list below.</p>
<p>The default values of these arguments correspond to the currently recommended way of running EISA. You can also run EISA exactly as it was described in <span class="citation">(Gaidatzis et al. 2015)</span>, by setting <code>method = "Gaidatzis2015"</code>. This will override the values of the five other arguments and set them according to the published algorithm (as indicated below).</p>
<ul>
<li>
<code>modelSamples</code>: Account for individual samples in statistical model? Possible values are:
<ul>
<li>
<code>FALSE</code> (default and <code>method="Gaidatzis2015"</code>): use a model of the form <code>~ condition * region</code><br>
</li>
<li>
<code>TRUE</code>: use a model of the form <code>~ sample + condition * region</code>
</li>
</ul>
</li>
<li>
<code>geneSelection</code>: How to select detected genes. Possible values are:
<ul>
<li>
<code>"filterByExpr"</code> (default): First, counts are normalized using <code><a href="https://rdrr.io/pkg/edgeR/man/calcNormFactors.html">edgeR::calcNormFactors</a></code>, treating intonic and exonic counts as individual samples. Then, the <code><a href="https://rdrr.io/pkg/edgeR/man/filterByExpr.html">edgeR::filterByExpr</a></code> function is used with default parameters to select quantifyable genes.</li>
<li>
<code>"none"</code>: This will use all the genes provided in the count tables, assuming that an appropriate selection of quantifyable genes has already been done.<br>
</li>
<li>
<code>"Gaidatzis2015"</code> (<code>method="Gaidatzis2015"</code>): First, intronic and exonic counts are linearly scaled to the mean library size (estimated as the sum of all intronic or exonic counts, respectively). Then, quantifyable genes are selected as the genes with counts <code>x</code> that fulfill <code>log2(x + 8) &gt; 5</code> in both exons and introns.</li>
</ul>
</li>
<li>
<code>statFramework</code>: The framework within <code>edgeR</code> that is used for the statistical analysis. Possible values are:
<ul>
<li>
<code>"QLF"</code> (default): quasi-likelihood F-test using <code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFTest.html">edgeR::glmQLFit</a></code> and <code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFTest.html">edgeR::glmQLFTest</a></code>. This framework is highly recommended as it gives stricter error rate control by accounting for the uncertainty in dispersion estimation.<br>
</li>
<li>
<code>"LRT"</code> (<code>method="Gaidatzis2015"</code>): likelyhood ratio test using <code><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html">edgeR::glmFit</a></code> and <code><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html">edgeR::glmLRT</a></code>.</li>
</ul>
</li>
<li>
<code>effects</code>: How the effects (log2 fold-changes) are calculated. Possible values are:
<ul>
<li>
<code>"predFC"</code> (default): Fold-changes are calculated using the fitted model with <code><a href="https://rdrr.io/pkg/edgeR/man/predFC.html">edgeR::predFC</a></code> and the value provided to <code>pscnt</code>. Please note that if a sample factor is included in the statistical model (<code>modelSamples=TRUE</code>), effects cannot be obtained from that model. In that case, effects are obtained from a simpler model without sample effects.</li>
<li>
<code>"Gaidatzis2015"</code> (<code>method="Gaidatzis2015"</code>): Fold-changes are calculated using the formula <code><a href="https://rdrr.io/r/base/Log.html">log2((x + pscnt)/(y + pscnt))</a></code>. If <code>pscnt</code> is not set to 8, <code>runEISA</code> will warn that this deviates from the method used in Gaidatzis et al., 2015.</li>
</ul>
</li>
<li>
<code>pscnt</code>: The pseudocount that is added to normalized counts before log transformation. For <code>geneSelection="Gaidatzis2015"</code>, <code>pscnt</code> is used both in gene selection as well as in the calculation of log2 fold-changes. Otherwise, <code>pscnt</code> is only used in the calculation of log2 fold-changes in <code><a href="https://rdrr.io/pkg/edgeR/man/predFC.html">edgeR::predFC(, prior.count = pscnt)</a></code>.</li>
</ul>
<p>While different values for these arguments typically yield similar results, the defaults are often less stringent compared to <code>method="Gaidatzis2015"</code> when selecting quantifyable genes, but more stringent when calling significant changes (especially with low numbers of replicates).</p>
<p>Here is an illustration of how the results differ <code>method="Gaidatzis2015"</code> and the defaults:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">res1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runEISA.html">runEISA</a></span>(Rex, Rin, cond, <span class="dt">method =</span> <span class="st">"Gaidatzis2015"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; setting parameters according to Gaidatzis et al., 2015</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; filtering quantifyable genes...keeping 8481 from 20288 (41.8%)</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; fitting statistical model...done</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; calculating contrasts...done</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">res2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runEISA.html">runEISA</a></span>(Rex, Rin, cond)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; filtering quantifyable genes...keeping 11034 from 20288 (54.4%)</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; fitting statistical model...done</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; calculating contrasts...done</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co"># number of quantifyable genes</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(res1<span class="op">$</span>DGEList)</a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; [1] 8481</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(res2<span class="op">$</span>DGEList)</a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; [1] 11034</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co"># number of genes with significant post-transcriptional regulation</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(res1<span class="op">$</span>tab.ExIn<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; [1] 490</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(res2<span class="op">$</span>tab.ExIn<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; [1] 131</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co"># method="Gaidatzis2015" results contain most of default results</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res2<span class="op">$</span>contrasts)[res2<span class="op">$</span>tab.ExIn<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] <span class="op">%in%</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="st">        </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res1<span class="op">$</span>contrasts)[res1<span class="op">$</span>tab.ExIn<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>])</a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt;    Mode   FALSE    TRUE </span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; logical      14     117</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co"># comparison of deltas</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30">ids &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res1<span class="op">$</span>DGEList), <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res2<span class="op">$</span>DGEList))</a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(res1<span class="op">$</span>contrasts[ids,<span class="st">"Dex"</span>], res2<span class="op">$</span>contrasts[ids,<span class="st">"Dex"</span>])</a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt; [1] 0.9958296</span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(res1<span class="op">$</span>contrasts[ids,<span class="st">"Din"</span>], res2<span class="op">$</span>contrasts[ids,<span class="st">"Din"</span>])</a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; [1] 0.9945688</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(res1<span class="op">$</span>contrasts[ids,<span class="st">"Dex.Din"</span>], res2<span class="op">$</span>contrasts[ids,<span class="st">"Dex.Din"</span>])</a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt; [1] 0.9722784</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(res1<span class="op">$</span>contrasts[ids,<span class="st">"Dex.Din"</span>], res2<span class="op">$</span>contrasts[ids,<span class="st">"Dex.Din"</span>], <span class="dt">pch =</span> <span class="st">"*"</span>,</a>
<a class="sourceLine" id="cb10-38" data-line-number="38">     <span class="dt">xlab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(Delta, <span class="st">"exon"</span>, <span class="op">-</span><span class="st"> </span>Delta, <span class="st">"intron for method='Gaidatzis2015'"</span>)),</a>
<a class="sourceLine" id="cb10-39" data-line-number="39">     <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(Delta, <span class="st">"exon"</span>, <span class="op">-</span><span class="st"> </span>Delta, <span class="st">"intron for default parameters"</span>)))</a></code></pre></div>
<p><img src="eisaR_files/figure-html/compare-1.png" width="700"></p>
</div>
<div id="on-the-estimation-of-interactions-in-a-split-plot-design-experiment" class="section level2">
<h2 class="hasAnchor">
<a href="#on-the-estimation-of-interactions-in-a-split-plot-design-experiment" class="anchor"></a>On the estimation of interactions in a split-plot design experiment</h2>
<p>The calculation of the significance of interactions (here whether the fold-changes differ between exonic or intronic data) is well defined for experimental designs were all samples are independent from one another. Within EISA, this is not the case (each sample yields two data points, on for exons and one for introns). That results in a dependency between datapoints: If a sample is affected by a problem in the experiment, it might at the same time give rise to outliers in both exonic and intronic counts.</p>
<p>In statistics, such an experimental design is often referred to as a split-plot design, and a recommended way to analyze interactions in such experiments would be to use a mixed effect model with the plot (in our case, the sample) as a random effect. The disadvantage here however would be that available packages for mixed effect models are not designed for count data, and we therefore use an alternative approach to explicitely model the sample dependency, by introducing a sample factor into the design matrix (for <code>modelSamples=TRUE</code>). That sample factor is nested in the condition factor (no sample can belong to more than one condition), and therefore not all coefficients can be estimated. We therefore drop one of the columns of the design matrix (identified by <code><a href="https://rdrr.io/pkg/limma/man/isfullrank.html">limma::nonEstimable</a></code>).</p>
<p>This has no impact on the effects (the log2 fold-changes of <code>modelSamples=TRUE</code> and <code>modelSamples=FALSE</code> are nearly identical). However, in the presence of sample effects, <code>modelSamples=TRUE</code> increases the sensitivity of detecting genes with significant interactions. Here is a comparison of the EISA results with and without accounting for the sample in the model:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">res3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runEISA.html">runEISA</a></span>(Rex, Rin, cond, <span class="dt">modelSamples =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; filtering quantifyable genes...keeping 11034 from 20288 (54.4%)</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; fitting statistical model...done</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; calculating contrasts...done</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">res4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runEISA.html">runEISA</a></span>(Rex, Rin, cond, <span class="dt">modelSamples =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; filtering quantifyable genes...keeping 11759 from 20288 (58%)</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; fitting statistical model...done</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; calculating contrasts...fitting model without sample factor...done</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">ids &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res3<span class="op">$</span>contrasts), <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res4<span class="op">$</span>contrasts))</a>
<a class="sourceLine" id="cb11-10" data-line-number="10"></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co"># number of genes with significant post-transcriptional regulation</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(res3<span class="op">$</span>tab.ExIn<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; [1] 131</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(res4<span class="op">$</span>tab.ExIn<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; [1] 900</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co"># modelSamples=TRUE results are a super-set of</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co"># modelSamples=FALSE results</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res3<span class="op">$</span>contrasts)[res3<span class="op">$</span>tab.ExIn<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] <span class="op">%in%</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="st">        </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res4<span class="op">$</span>contrasts)[res4<span class="op">$</span>tab.ExIn<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>])</a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#&gt;    Mode    TRUE </span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#&gt; logical     131</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co"># comparison of contrasts</span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(res3<span class="op">$</span>contrasts[ids, ], res4<span class="op">$</span>contrasts[ids, ]))</a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="co">#&gt;       Dex       Din   Dex.Din </span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="co">#&gt; 0.9999998 0.9999983 0.9958381</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(res3<span class="op">$</span>contrasts[ids, <span class="dv">3</span>], res4<span class="op">$</span>contrasts[ids, <span class="dv">3</span>], <span class="dt">pch =</span> <span class="st">"*"</span>,</a>
<a class="sourceLine" id="cb11-29" data-line-number="29">     <span class="dt">xlab =</span> <span class="st">"Interaction effects for modelSamples=FALSE"</span>,</a>
<a class="sourceLine" id="cb11-30" data-line-number="30">     <span class="dt">ylab =</span> <span class="st">"Interaction effects for modelSamples=TRUE"</span>)</a></code></pre></div>
<p><img src="eisaR_files/figure-html/modelSamples-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co"># comparison of interaction significance</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(res3<span class="op">$</span>tab.ExIn[ids, <span class="st">"FDR"</span>]), <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(res4<span class="op">$</span>tab.ExIn[ids, <span class="st">"FDR"</span>]), <span class="dt">pch =</span> <span class="st">"*"</span>,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">     <span class="dt">xlab =</span> <span class="st">"-log10(FDR) for modelSamples=FALSE"</span>,</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">     <span class="dt">ylab =</span> <span class="st">"-log10(FDR) for modelSamples=TRUE"</span>)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">a=</span><span class="dv">0</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">"gray"</span>)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>, <span class="st">"y = x"</span>, <span class="dt">bty =</span> <span class="st">"n"</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">"gray"</span>)</a></code></pre></div>
<p><img src="eisaR_files/figure-html/modelSamples-2.png" width="700"></p>
</div>
</div>
<div id="plot" class="section level1">
<h1 class="hasAnchor">
<a href="#plot" class="anchor"></a>Visualize EISA results</h1>
<p>We can now visualize the results by plotting intronic changes versus exonic changes (genes with signficant interactions, which are likely to be post-transcriptionally regulated, are color coded):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/plotEISA.html">plotEISA</a></span>(res)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; identified 131 genes to highlight</span></a></code></pre></div>
<p><img src="eisaR_files/figure-html/plotEISA-1.png" width="700"></p>
</div>
<div id="stepwise" class="section level1">
<h1 class="hasAnchor">
<a href="#stepwise" class="anchor"></a>Run EISA step-by-step</h1>
<p>As an alternative to <code>runEISA</code> (section @ref(convenient)) and <code>plotEISA</code> (section @ref(plot)) described above, you can also analyse the data step-by-step as described in <span class="citation">(Gaidatzis et al. 2015)</span>. This may be preferrable to understand each individual step and be able to access intermediate results.</p>
<p>The results obtained in this way are identical to what you get with <code><a href="../reference/runEISA.html">runEISA(..., method = "Gaidatzis2015")</a></code>, so if you are happy with <code>runEISA</code> you can skip the rest of the vignette.</p>
<div id="normalization" class="section level2">
<h2 class="hasAnchor">
<a href="#normalization" class="anchor"></a>Normalization</h2>
<p>Normalization is performed separately on exonic and intronic counts, assuming that varying exon over intron ratios between samples are of technical origin.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># remove column "width"</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">Rex &lt;-<span class="st"> </span>cntEx[,<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(cntEx) <span class="op">!=</span><span class="st"> "width"</span>]</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">Rin &lt;-<span class="st"> </span>cntIn[,<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(cntIn) <span class="op">!=</span><span class="st"> "width"</span>]</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">Rall &lt;-<span class="st"> </span>Rex <span class="op">+</span><span class="st"> </span>Rin</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">fracIn &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(Rin)<span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(Rall)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(fracIn)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt;  0.2696  0.2977  0.3105  0.3459  0.3587  0.4929</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co"># scale counts to the mean library size,</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co"># separately for exons and introns</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">Nex &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(Rex) <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(Rex) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(Rex)))</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">Nin &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(Rin) <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(Rin) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(Rin)))</a>
<a class="sourceLine" id="cb14-14" data-line-number="14"></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co"># log transform (add a pseudocount of 8)</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16">NLex &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(Nex <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">NLin &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(Nin <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)</a></code></pre></div>
</div>
<div id="identify-quantifyable-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#identify-quantifyable-genes" class="anchor"></a>Identify quantifyable genes</h2>
<p>Genes with very low counts in either exons or introns are better removed, as they will be too noisy to yield useful results. We use here a fixed cut-off on the normalized, log-transformed intron and exonic counts:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">quantGenes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(Rex)[ <span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(NLex) <span class="op">&gt;</span><span class="st"> </span><span class="fl">5.0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(NLin) <span class="op">&gt;</span><span class="st"> </span><span class="fl">5.0</span> ]</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(quantGenes)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt; [1] 8481</span></a></code></pre></div>
</div>
<div id="calculate-delta-i-delta-e-and-delta-e---delta-i" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-delta-i-delta-e-and-delta-e---delta-i" class="anchor"></a>Calculate <span class="math inline">\(\Delta I\)</span>, <span class="math inline">\(\Delta E\)</span> and <span class="math inline">\(\Delta E - \Delta I\)</span>
</h2>
<p>The count tables were obtained from a total RNA-seq experiments in mouse embryonic stem (MmES) cells and derived terminal neurons (MmTN), with two replicates for each condition.</p>
<p>We will now calculate the changes between neurons and ES cells in introns (<span class="math inline">\(\Delta I\)</span>), in exons (<span class="math inline">\(\Delta E\)</span>), and the difference between the two (<span class="math inline">\(\Delta E - \Delta I\)</span>):</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">Dex &lt;-<span class="st"> </span>NLex[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MmTN_RNA_total_a"</span>,<span class="st">"MmTN_RNA_total_b"</span>)] <span class="op">-</span><span class="st"> </span>NLex[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MmES_RNA_total_a"</span>,<span class="st">"MmES_RNA_total_b"</span>)]</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">Din &lt;-<span class="st"> </span>NLin[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MmTN_RNA_total_a"</span>,<span class="st">"MmTN_RNA_total_b"</span>)] <span class="op">-</span><span class="st"> </span>NLin[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MmES_RNA_total_a"</span>,<span class="st">"MmES_RNA_total_b"</span>)]</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">Dex.Din &lt;-<span class="st"> </span>Dex <span class="op">-</span><span class="st"> </span>Din</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(Dex[quantGenes,<span class="dv">1</span>], Dex[quantGenes,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt; [1] 0.9379397</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(Din[quantGenes,<span class="dv">1</span>], Din[quantGenes,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt; [1] 0.8449252</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(Dex.Din[quantGenes,<span class="dv">1</span>], Dex.Din[quantGenes,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt; [1] 0.5518187</span></a></code></pre></div>
<p>Both exonic and intronic changes are correlated across replicates, and so are the differences, indicating a reproducible signal for post-transcriptional regulation.</p>
</div>
<div id="statistical-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#statistical-analysis" class="anchor"></a>Statistical analysis</h2>
<p>Finally, we use the replicate measurement in the <em><a href="https://bioconductor.org/packages/3.11/edgeR">edgeR</a></em> framework to calculate the significance of the changes:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># create DGEList object with exonic and intronic counts</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(edgeR)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt; Loading required package: limma</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt; Attaching package: 'limma'</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt; The following object is masked from 'package:BiocGenerics':</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">#&gt;     plotMA</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9">cnt &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">Ex =</span> Rex, <span class="dt">In =</span> Rin)</a>
<a class="sourceLine" id="cb17-10" data-line-number="10">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html">DGEList</a></span>(<span class="dt">counts =</span> cnt, <span class="dt">genes =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">ENTREZID =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(cnt)))</a>
<a class="sourceLine" id="cb17-11" data-line-number="11"></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co"># select quantifyable genes and normalize</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13">y &lt;-<span class="st"> </span>y[quantGenes, ]</a>
<a class="sourceLine" id="cb17-14" data-line-number="14">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/edgeR/man/calcNormFactors.html">calcNormFactors</a></span>(y)</a>
<a class="sourceLine" id="cb17-15" data-line-number="15"></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co"># design matrix with interaction term</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17">region &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ex"</span>,<span class="st">"ex"</span>,<span class="st">"ex"</span>,<span class="st">"ex"</span>,<span class="st">"in"</span>,<span class="st">"in"</span>,<span class="st">"in"</span>,<span class="st">"in"</span>), <span class="dt">levels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"in"</span>, <span class="st">"ex"</span>))</a>
<a class="sourceLine" id="cb17-18" data-line-number="18">cond &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ES"</span>,<span class="st">"ES"</span>,<span class="st">"TN"</span>,<span class="st">"TN"</span>)), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-19" data-line-number="19">design &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span>region <span class="op">*</span><span class="st"> </span>cond)</a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(design) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(cnt)</a>
<a class="sourceLine" id="cb17-21" data-line-number="21">design</a>
<a class="sourceLine" id="cb17-22" data-line-number="22"><span class="co">#&gt;                     (Intercept) regionex condTN regionex:condTN</span></a>
<a class="sourceLine" id="cb17-23" data-line-number="23"><span class="co">#&gt; Ex.MmES_RNA_total_a           1        1      0               0</span></a>
<a class="sourceLine" id="cb17-24" data-line-number="24"><span class="co">#&gt; Ex.MmES_RNA_total_b           1        1      0               0</span></a>
<a class="sourceLine" id="cb17-25" data-line-number="25"><span class="co">#&gt; Ex.MmTN_RNA_total_a           1        1      1               1</span></a>
<a class="sourceLine" id="cb17-26" data-line-number="26"><span class="co">#&gt; Ex.MmTN_RNA_total_b           1        1      1               1</span></a>
<a class="sourceLine" id="cb17-27" data-line-number="27"><span class="co">#&gt; In.MmES_RNA_total_a           1        0      0               0</span></a>
<a class="sourceLine" id="cb17-28" data-line-number="28"><span class="co">#&gt; In.MmES_RNA_total_b           1        0      0               0</span></a>
<a class="sourceLine" id="cb17-29" data-line-number="29"><span class="co">#&gt; In.MmTN_RNA_total_a           1        0      1               0</span></a>
<a class="sourceLine" id="cb17-30" data-line-number="30"><span class="co">#&gt; In.MmTN_RNA_total_b           1        0      1               0</span></a>
<a class="sourceLine" id="cb17-31" data-line-number="31"><span class="co">#&gt; attr(,"assign")</span></a>
<a class="sourceLine" id="cb17-32" data-line-number="32"><span class="co">#&gt; [1] 0 1 2 3</span></a>
<a class="sourceLine" id="cb17-33" data-line-number="33"><span class="co">#&gt; attr(,"contrasts")</span></a>
<a class="sourceLine" id="cb17-34" data-line-number="34"><span class="co">#&gt; attr(,"contrasts")$region</span></a>
<a class="sourceLine" id="cb17-35" data-line-number="35"><span class="co">#&gt; [1] "contr.treatment"</span></a>
<a class="sourceLine" id="cb17-36" data-line-number="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb17-37" data-line-number="37"><span class="co">#&gt; attr(,"contrasts")$cond</span></a>
<a class="sourceLine" id="cb17-38" data-line-number="38"><span class="co">#&gt; [1] "contr.treatment"</span></a>
<a class="sourceLine" id="cb17-39" data-line-number="39"></a>
<a class="sourceLine" id="cb17-40" data-line-number="40"><span class="co"># estimate model parameters</span></a>
<a class="sourceLine" id="cb17-41" data-line-number="41">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/edgeR/man/estimateDisp.html">estimateDisp</a></span>(y, design)</a>
<a class="sourceLine" id="cb17-42" data-line-number="42">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html">glmFit</a></span>(y, design)</a>
<a class="sourceLine" id="cb17-43" data-line-number="43"></a>
<a class="sourceLine" id="cb17-44" data-line-number="44"><span class="co"># calculate likelihood-ratio between full and reduced models</span></a>
<a class="sourceLine" id="cb17-45" data-line-number="45">lrt &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html">glmLRT</a></span>(fit)</a>
<a class="sourceLine" id="cb17-46" data-line-number="46"></a>
<a class="sourceLine" id="cb17-47" data-line-number="47"><span class="co"># create results table</span></a>
<a class="sourceLine" id="cb17-48" data-line-number="48">tt &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/edgeR/man/topTags.html">topTags</a></span>(lrt, <span class="dt">n =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(y), <span class="dt">sort.by =</span> <span class="st">"none"</span>)</a>
<a class="sourceLine" id="cb17-49" data-line-number="49"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tt<span class="op">$</span>table[<span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(tt<span class="op">$</span>table<span class="op">$</span>FDR, <span class="dt">decreasing =</span> <span class="ot">FALSE</span>), ])</a>
<a class="sourceLine" id="cb17-50" data-line-number="50"><span class="co">#&gt;        ENTREZID    logFC   logCPM       LR       PValue          FDR</span></a>
<a class="sourceLine" id="cb17-51" data-line-number="51"><span class="co">#&gt; 14680     14680 6.375699 6.554051 95.79494 1.274210e-22 1.080658e-18</span></a>
<a class="sourceLine" id="cb17-52" data-line-number="52"><span class="co">#&gt; 75209     75209 5.341413 6.400361 85.66167 2.135122e-20 9.053983e-17</span></a>
<a class="sourceLine" id="cb17-53" data-line-number="53"><span class="co">#&gt; 268354   268354 9.854778 8.402066 53.71350 2.319637e-13 6.557614e-10</span></a>
<a class="sourceLine" id="cb17-54" data-line-number="54"><span class="co">#&gt; 17957     17957 4.342644 6.864176 51.63948 6.668718e-13 1.413935e-09</span></a>
<a class="sourceLine" id="cb17-55" data-line-number="55"><span class="co">#&gt; 93765     93765 3.849670 6.603142 51.08555 8.842689e-13 1.499897e-09</span></a>
<a class="sourceLine" id="cb17-56" data-line-number="56"><span class="co">#&gt; 68666     68666 4.536512 5.872792 48.29846 3.660400e-12 5.173976e-09</span></a></code></pre></div>
</div>
<div id="visualize-the-results" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-the-results" class="anchor"></a>Visualize the results</h2>
<p>Finally, we visualize the results by plotting intronic changes versus exonic changes (genes with signficant interactions, which are likely to be post-transcriptionally regulated, are color coded):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">sig     &lt;-<span class="st"> </span>tt<span class="op">$</span>table<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sig)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; [1] 490</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">sig.dir &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(tt<span class="op">$</span>table<span class="op">$</span>logFC[sig])</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">cols &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(sig, <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(tt<span class="op">$</span>table<span class="op">$</span>logFC <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="st">"#E41A1CFF"</span>, <span class="st">"#497AB3FF"</span>), <span class="st">"#22222244"</span>)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co"># volcano plot</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(tt<span class="op">$</span>table<span class="op">$</span>logFC, <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(tt<span class="op">$</span>table<span class="op">$</span>FDR), <span class="dt">col =</span> cols, <span class="dt">pch =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">     <span class="dt">xlab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"RNA change (log2 "</span>,Delta,<span class="st">"exon/"</span>,Delta,<span class="st">"intron)"</span>)),</a>
<a class="sourceLine" id="cb18-10" data-line-number="10">     <span class="dt">ylab =</span> <span class="st">"Significance (-log10 FDR)"</span>)</a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">h =</span> <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="fl">0.05</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">"usr"</span>)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">"cxy"</span>)[<span class="dv">1</span>], <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">"usr"</span>)[<span class="dv">4</span>], <span class="dt">adj =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb18-14" data-line-number="14">     <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"n=%d"</span>, <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sig.dir <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>)), <span class="dt">col =</span> <span class="st">"#497AB3FF"</span>)</a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">"usr"</span>)[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">"cxy"</span>)[<span class="dv">1</span>], <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">"usr"</span>)[<span class="dv">4</span>], <span class="dt">adj =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb18-16" data-line-number="16">     <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"n=%d"</span>, <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sig.dir <span class="op">==</span><span class="st">  </span><span class="dv">1</span>)), <span class="dt">col =</span> <span class="st">"#E41A1CFF"</span>)</a></code></pre></div>
<p><img src="eisaR_files/figure-html/plot-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co"># Delta I vs. Delta E</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(Din)[quantGenes], <span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(Dex)[quantGenes], <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> cols,</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">     <span class="dt">xlab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(Delta,<span class="st">"intron (log2 TN/ES)"</span>)),</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">     <span class="dt">ylab =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(Delta,<span class="st">"exon (log2 TN/ES)"</span>)))</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="dt">x =</span> <span class="st">"bottomright"</span>, <span class="dt">bty =</span> <span class="st">"n"</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#E41A1CFF"</span>,<span class="st">"#497AB3FF"</span>),</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">       <span class="dt">legend =</span> <span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%s (%d)"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Up"</span>,<span class="st">"Down"</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sig.dir <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sig.dir <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>))))</a></code></pre></div>
<p><img src="eisaR_files/figure-html/plot-2.png" width="700"></p>
</div>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<p>The output in this vignette was produced under:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt; R Under development (unstable) (2020-02-18 r77821)</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt; Running under: Ubuntu 16.04.6 LTS</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt; Matrix products: default</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt; BLAS:   /home/travis/R-bin/lib/R/lib/libRblas.so</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt; LAPACK: /home/travis/R-bin/lib/R/lib/libRlapack.so</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; locale:</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt; attached base packages:</span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">#&gt; [1] stats4    parallel  stats     graphics  grDevices utils     datasets </span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co">#&gt; [8] methods   base     </span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22"><span class="co">#&gt; other attached packages:</span></a>
<a class="sourceLine" id="cb20-23" data-line-number="23"><span class="co">#&gt;  [1] edgeR_3.29.0           limma_3.43.4           QuasR_1.27.0          </span></a>
<a class="sourceLine" id="cb20-24" data-line-number="24"><span class="co">#&gt;  [4] Rbowtie_1.27.1         rtracklayer_1.47.0     GenomicFeatures_1.39.5</span></a>
<a class="sourceLine" id="cb20-25" data-line-number="25"><span class="co">#&gt;  [7] AnnotationDbi_1.49.1   Biobase_2.47.2         GenomicRanges_1.39.2  </span></a>
<a class="sourceLine" id="cb20-26" data-line-number="26"><span class="co">#&gt; [10] GenomeInfoDb_1.23.13   IRanges_2.21.3         S4Vectors_0.25.12     </span></a>
<a class="sourceLine" id="cb20-27" data-line-number="27"><span class="co">#&gt; [13] BiocGenerics_0.33.0    eisaR_0.8              BiocStyle_2.15.6      </span></a>
<a class="sourceLine" id="cb20-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb20-29" data-line-number="29"><span class="co">#&gt; loaded via a namespace (and not attached):</span></a>
<a class="sourceLine" id="cb20-30" data-line-number="30"><span class="co">#&gt;  [1] httr_1.4.1                  splines_4.0.0              </span></a>
<a class="sourceLine" id="cb20-31" data-line-number="31"><span class="co">#&gt;  [3] bit64_0.9-7                 GenomicFiles_1.23.0        </span></a>
<a class="sourceLine" id="cb20-32" data-line-number="32"><span class="co">#&gt;  [5] assertthat_0.2.1            askpass_1.1                </span></a>
<a class="sourceLine" id="cb20-33" data-line-number="33"><span class="co">#&gt;  [7] BiocManager_1.30.10         BiocFileCache_1.11.4       </span></a>
<a class="sourceLine" id="cb20-34" data-line-number="34"><span class="co">#&gt;  [9] latticeExtra_0.6-29         blob_1.2.1                 </span></a>
<a class="sourceLine" id="cb20-35" data-line-number="35"><span class="co">#&gt; [11] BSgenome_1.55.3             GenomeInfoDbData_1.2.2     </span></a>
<a class="sourceLine" id="cb20-36" data-line-number="36"><span class="co">#&gt; [13] Rsamtools_2.3.4             yaml_2.2.1                 </span></a>
<a class="sourceLine" id="cb20-37" data-line-number="37"><span class="co">#&gt; [15] progress_1.2.2              pillar_1.4.3               </span></a>
<a class="sourceLine" id="cb20-38" data-line-number="38"><span class="co">#&gt; [17] RSQLite_2.2.0               backports_1.1.5            </span></a>
<a class="sourceLine" id="cb20-39" data-line-number="39"><span class="co">#&gt; [19] lattice_0.20-38             glue_1.3.1                 </span></a>
<a class="sourceLine" id="cb20-40" data-line-number="40"><span class="co">#&gt; [21] digest_0.6.24               RColorBrewer_1.1-2         </span></a>
<a class="sourceLine" id="cb20-41" data-line-number="41"><span class="co">#&gt; [23] XVector_0.27.0              htmltools_0.4.0            </span></a>
<a class="sourceLine" id="cb20-42" data-line-number="42"><span class="co">#&gt; [25] Matrix_1.2-18               XML_3.99-0.3               </span></a>
<a class="sourceLine" id="cb20-43" data-line-number="43"><span class="co">#&gt; [27] pkgconfig_2.0.3             ShortRead_1.45.3           </span></a>
<a class="sourceLine" id="cb20-44" data-line-number="44"><span class="co">#&gt; [29] biomaRt_2.43.3              bookdown_0.17              </span></a>
<a class="sourceLine" id="cb20-45" data-line-number="45"><span class="co">#&gt; [31] zlibbioc_1.33.1             purrr_0.3.3                </span></a>
<a class="sourceLine" id="cb20-46" data-line-number="46"><span class="co">#&gt; [33] jpeg_0.1-8.1                BiocParallel_1.21.2        </span></a>
<a class="sourceLine" id="cb20-47" data-line-number="47"><span class="co">#&gt; [35] tibble_2.1.3                openssl_1.4.1              </span></a>
<a class="sourceLine" id="cb20-48" data-line-number="48"><span class="co">#&gt; [37] SummarizedExperiment_1.17.2 magrittr_1.5               </span></a>
<a class="sourceLine" id="cb20-49" data-line-number="49"><span class="co">#&gt; [39] crayon_1.3.4                memoise_1.1.0              </span></a>
<a class="sourceLine" id="cb20-50" data-line-number="50"><span class="co">#&gt; [41] evaluate_0.14               fs_1.3.1                   </span></a>
<a class="sourceLine" id="cb20-51" data-line-number="51"><span class="co">#&gt; [43] MASS_7.3-51.5               hwriter_1.3.2              </span></a>
<a class="sourceLine" id="cb20-52" data-line-number="52"><span class="co">#&gt; [45] tools_4.0.0                 prettyunits_1.1.1          </span></a>
<a class="sourceLine" id="cb20-53" data-line-number="53"><span class="co">#&gt; [47] hms_0.5.3                   matrixStats_0.55.0         </span></a>
<a class="sourceLine" id="cb20-54" data-line-number="54"><span class="co">#&gt; [49] stringr_1.4.0               locfit_1.5-9.1             </span></a>
<a class="sourceLine" id="cb20-55" data-line-number="55"><span class="co">#&gt; [51] DelayedArray_0.13.4         Biostrings_2.55.4          </span></a>
<a class="sourceLine" id="cb20-56" data-line-number="56"><span class="co">#&gt; [53] compiler_4.0.0              pkgdown_1.4.1              </span></a>
<a class="sourceLine" id="cb20-57" data-line-number="57"><span class="co">#&gt; [55] rlang_0.4.4                 grid_4.0.0                 </span></a>
<a class="sourceLine" id="cb20-58" data-line-number="58"><span class="co">#&gt; [57] RCurl_1.98-1.1              VariantAnnotation_1.33.0   </span></a>
<a class="sourceLine" id="cb20-59" data-line-number="59"><span class="co">#&gt; [59] rappdirs_0.3.1              bitops_1.0-6               </span></a>
<a class="sourceLine" id="cb20-60" data-line-number="60"><span class="co">#&gt; [61] rmarkdown_2.1               DBI_1.1.0                  </span></a>
<a class="sourceLine" id="cb20-61" data-line-number="61"><span class="co">#&gt; [63] curl_4.3                    R6_2.4.1                   </span></a>
<a class="sourceLine" id="cb20-62" data-line-number="62"><span class="co">#&gt; [65] GenomicAlignments_1.23.1    knitr_1.28                 </span></a>
<a class="sourceLine" id="cb20-63" data-line-number="63"><span class="co">#&gt; [67] dplyr_0.8.4                 bit_1.1-15.2               </span></a>
<a class="sourceLine" id="cb20-64" data-line-number="64"><span class="co">#&gt; [69] rprojroot_1.3-2             desc_1.2.0                 </span></a>
<a class="sourceLine" id="cb20-65" data-line-number="65"><span class="co">#&gt; [71] stringi_1.4.6               Rcpp_1.0.3                 </span></a>
<a class="sourceLine" id="cb20-66" data-line-number="66"><span class="co">#&gt; [73] png_0.1-7                   vctrs_0.2.2                </span></a>
<a class="sourceLine" id="cb20-67" data-line-number="67"><span class="co">#&gt; [75] dbplyr_1.4.2                tidyselect_1.0.0           </span></a>
<a class="sourceLine" id="cb20-68" data-line-number="68"><span class="co">#&gt; [77] xfun_0.12</span></a></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-eisa">
<p>Gaidatzis, D., L. Burger, M. Florescu, and M.B. Stadler. 2015. “Analysis of Intronic and Exonic Reads in Rna-Seq Data Characterizes Transcriptional and Post-Transcriptional Regulation.” <em>Nature Biotechnology</em> 33 (7): 722–29. <a href="https://doi.org/10.1038/nbt.3269" class="uri">https://doi.org/10.1038/nbt.3269</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#annotation">Preparing the annotation</a></li>
      <li>
<a href="#quantify-rna-seq-alignments-in-exons-and-introns">Quantify RNA-seq alignments in exons and introns</a><ul class="nav nav-pills nav-stacked">
<li><a href="#align">Align reads</a></li>
      <li><a href="#count">Count alignments in exons and gene bodies</a></li>
      <li><a href="#load-full-count-tables">Load full count tables</a></li>
      </ul>
</li>
      <li>
<a href="#convenient">Run EISA conveniently</a><ul class="nav nav-pills nav-stacked">
<li><a href="#alternative-implementations-of-eisa">Alternative implementations of EISA</a></li>
      <li><a href="#on-the-estimation-of-interactions-in-a-split-plot-design-experiment">On the estimation of interactions in a split-plot design experiment</a></li>
      </ul>
</li>
      <li><a href="#plot">Visualize EISA results</a></li>
      <li>
<a href="#stepwise">Run EISA step-by-step</a><ul class="nav nav-pills nav-stacked">
<li><a href="#normalization">Normalization</a></li>
      <li><a href="#identify-quantifyable-genes">Identify quantifyable genes</a></li>
      <li><a href="#calculate-delta-i-delta-e-and-delta-e---delta-i">Calculate <span class="math inline">\(\Delta I\)</span>, <span class="math inline">\(\Delta E\)</span> and <span class="math inline">\(\Delta E - \Delta I\)</span></a></li>
      <li><a href="#statistical-analysis">Statistical analysis</a></li>
      <li><a href="#visualize-the-results">Visualize the results</a></li>
      </ul>
</li>
      <li><a href="#session-information">Session information</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/mbstadler">Michael Stadler</a>, Dimos Gaidatzis, <a href="https://github.com/LukasBurger">Lukas Burger</a>, <a href="https://csoneson.github.io">Charlotte Soneson</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
