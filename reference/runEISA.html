<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run Exon-Intron Split Analysis. — runEISA • eisaR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run Exon-Intron Split Analysis. — runEISA" />
<meta property="og:description" content="Starting from count tables with exonic and intronic counts
for two conditions, perform all the steps in EISA (normalize, identify
quantifyable genes, calculate contrasts and their significance)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eisaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/eisaR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/eisaR.html">eisaR</a>
    </li>
    <li>
      <a href="../articles/rna-velocity.html">Feature extraction for RNA velocity</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/fmicompbio/eisaR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run Exon-Intron Split Analysis.</h1>
    
    <div class="hidden name"><code>runEISA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Starting from count tables with exonic and intronic counts
for two conditions, perform all the steps in EISA (normalize, identify
quantifyable genes, calculate contrasts and their significance).</p>
    </div>

    <pre class="usage"><span class='fu'>runEISA</span>(
  <span class='no'>cntEx</span>,
  <span class='no'>cntIn</span>,
  <span class='no'>cond</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>modelSamples</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>geneSelection</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"filterByExpr"</span>, <span class='st'>"none"</span>, <span class='st'>"Gaidatzis2015"</span>),
  <span class='kw'>statFramework</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"QLF"</span>, <span class='st'>"LRT"</span>),
  <span class='kw'>effects</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"predFC"</span>, <span class='st'>"Gaidatzis2015"</span>),
  <span class='kw'>pscnt</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cntEx</th>
      <td><p>Gene by sample <code>matrix</code> with exonic counts, OR a
<code>SummarizedExperiment</code> with two assays named <code>exon</code> and
<code>intron</code>, containing exonic and intronic counts, respectively. If
<code>cntEx</code> is a <code>SummarizedExperiment</code>, <code>cntIn</code> will be
disregarded.</p></td>
    </tr>
    <tr>
      <th>cntIn</th>
      <td><p>Gene by sample <code>matrix</code> with intronic counts. Must have the
same structure as <code>cntEx</code> (same number and order of rows and columns)
if <code>cntEx</code> is a matrix. Will be disregarded if <code>cntEx</code> is a
<code>SummarizedExperiment</code>.</p></td>
    </tr>
    <tr>
      <th>cond</th>
      <td><p><code>numeric</code>, <code>character</code> or <code>factor</code> with two levels
that groups the samples (columns of <code>cntEx</code> and <code>cntIn</code>) into two
conditions. The contrast will be defined as secondLevel - firstLevel.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>One of <code>NULL</code> (the default) or <code>"Gaidatzis2015"</code>. If
<code>"Gaidatzis2015"</code>, gene filtering, statistical analysis and
calculation of contrasts is performed as described in Gaidatzis et al.
2015, and the statistical analysis is based on <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmFit</a></code>
and <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmLRT</a></code>. This is done by setting the arguments
<code>modelSamples</code>, <code>geneSelection</code>, <code>effects</code> and <code>statFramework</code>
to appropriate values (see details), overriding the defaults or any value
passed to these arguments. If <code>NULL</code>, the default values of the arguments
will be used instead (recommended).</p></td>
    </tr>
    <tr>
      <th>modelSamples</th>
      <td><p>Whether to include a sample identifier in the design matrix
of the statistical model. If <code>TRUE</code>, potential sample effects
that affect both exonic and intronic counts of that sample will be taken
into account, which could result in higher sensitivity (default: FALSE).</p></td>
    </tr>
    <tr>
      <th>geneSelection</th>
      <td><p>Controls how to select quantifyable genes. One of the
following:</p><dl class='dl-horizontal'>
<dt><code>"filterByExpr"</code>: </dt><dd><p>(default) First, counts are normalized using
<code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></code>, treating intonic and exonic counts
as individual samples. Then, <code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></code> is used
with default parameters to select quantifyable genes.</p></dd>
<dt><code>"none"</code>: </dt><dd><p>This will use all the genes provided in the count
tables, assuming that an appropriate selection of quantifyable genes has
already been done.</p></dd>
<dt><code>"Gaidatzis2015"</code>: </dt><dd><p>First, intronic and exonic counts are
linearly scaled to the mean library size (estimated as the sum of all
intronic or exonic counts, respectively). Then, quantifyable genes are
selected as the genes with counts <code>x</code> that fulfill
<code>log2(x + 8) &gt; 5</code> in both exons and introns.</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>statFramework</th>
      <td><p>Selects the framework within <code>edgeR</code> that is used
for the statistical analysis. One of:</p><dl class='dl-horizontal'>
<dt><code>"QLF"</code>: </dt><dd><p>(default) Quasi-likelihood F-test using
<code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFit</a></code> and <code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFTest</a></code>. This
framework is highly recommended as it gives stricter error rate control
by accounting for the uncertainty in dispersion estimation.</p></dd>
<dt><code>"LRT"</code>: </dt><dd><p>Likelyhood ratio test using <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmFit</a></code>
and <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmLRT</a></code></p></dd>.

</dl></td>
    </tr>
    <tr>
      <th>effects</th>
      <td><p>How the effects (contrasts or log2 fold-changes) are calculated.
One of:</p><dl class='dl-horizontal'>
<dt><code>"predFC"</code>: </dt><dd><p>(default) Fold-changes are calculated using
the fitted model with <code><a href='https://rdrr.io/pkg/edgeR/man/predFC.html'>predFC</a></code> with
<code>prior.count = pscnt</code>. Please note that if a sample factor is
included in the model (<code>modelSamples=TRUE</code>), effects cannot be
obtained from that model. In that case, effects are obtained from a
simpler model without sample effects.</p></dd>
<dt><code>"Gaidatzis2015"</code>: </dt><dd><p>Fold-changes are calculated using the
formula <code><a href='https://rdrr.io/r/base/Log.html'>log2((x + pscnt)/(y + pscnt))</a></code>. If <code>pscnt</code> is not
set to 8, <code>runEISA</code> will warn that this deviates from the method
used in Gaidatzis et al., 2015.</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>pscnt</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> with pseudocount to add to read counts
(default: 2). For <code>method = "Gaidatzis2015"</code>, it is set to 8.
It is added to scaled read counts used in <code>geneSelection = "Gaidatzis2015"</code>
and <code>effects = "Gaidatzis2015"</code>, or else used in <code>cpm(..., prior.count = pscnt)</code>
and <code>predFC(..., prior.count = pscnt)</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to the <code><a href='https://rdrr.io/pkg/edgeR/man/DGEList.html'>DGEList</a></code>
constructor, such as <code>lib.size</code> or <code>genes</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>list</code> with elements</p><dl class='dl-horizontal'>
<dt>fracIn</dt><dd><p>fraction intronic counts in each sample</p></dd>
<dt>contrastName</dt><dd><p>contrast name</p></dd>
<dt>contrasts</dt><dd><p>contrast matrix for quantifyable genes, with average log2
fold-changes in exons (<code>Dex</code>), in introns (<code>Din</code>), and average
difference between log2 fold-changes in exons and introns (<code>Dex.Din</code>)</p></dd>
<dt>DGEList</dt><dd><p><code><a href='https://rdrr.io/pkg/edgeR/man/DGEList.html'>DGEList</a></code> object used in model fitting</p></dd>
<dt>tab.ExIn</dt><dd><p>statisical results for differential changes between exonic
and intronic contrast, an indication for post-transcriptional regulation.</p></dd>
<dt>params</dt><dd><p>a <code>list</code> with parameter values used to run EISA</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Setting <code>method = "Gaidatzis2015"</code> has precedence over other
argument values and corresponds to setting:
<code>modelSamples = FALSE, geneSelection = "Gaidatzis2015",
  statFramework = "LRT", effects = "Gaidatzis2015", pscnt = 8</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Analysis of intronic and exonic reads in RNA-seq data characterizes
transcriptional and post-transcriptional regulation.
Dimos Gaidatzis, Lukas Burger, Maria Florescu and Michael B. Stadler
Nature Biotechnology, 2015 Jul;33(7):722-9. doi: 10.1038/nbt.3269.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/edgeR/man/DGEList.html'>DGEList</a></code> for <code>DGEList</code> object construction,
<code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></code> for normalization,
<code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></code> for gene selection,
<code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmFit</a></code> and <code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFit</a></code> for statistical
analysis.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>cntEx</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"Fig3abc_GSE33252_rawcounts_exonic.rds"</span>,
                             <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"eisaR"</span>))[,-<span class='fl'>1</span>]
<span class='no'>cntIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"Fig3abc_GSE33252_rawcounts_intronic.rds"</span>,
                             <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"eisaR"</span>))[,-<span class='fl'>1</span>]
<span class='no'>cond</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"ES"</span>,<span class='st'>"ES"</span>,<span class='st'>"TN"</span>,<span class='st'>"TN"</span>))
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>runEISA</span>(<span class='no'>cntEx</span>, <span class='no'>cntIn</span>, <span class='no'>cond</span>)</div><div class='output co'>#&gt; <span class='message'>filtering quantifyable genes...</span></div><div class='output co'>#&gt; <span class='message'>keeping 11034 from 20288 (54.4%)</span></div><div class='output co'>#&gt; <span class='message'>fitting statistical model...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div><div class='output co'>#&gt; <span class='message'>calculating contrasts...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div><div class='input'><span class='fu'><a href='plotEISA.html'>plotEISA</a></span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; <span class='message'>identified 131 genes to highlight</span></div><div class='img'><img src='runEISA-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Michael Stadler</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/mbstadler'>Michael Stadler</a>, Dimos Gaidatzis, <a href='https://github.com/LukasBurger'>Lukas Burger</a>, <a href='https://csoneson.github.io'>Charlotte Soneson</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


