<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run Exon-Intron Split Analysis. — runEISA • eisaR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run Exon-Intron Split Analysis. — runEISA"><meta property="og:description" content="Starting from count tables with exonic and intronic counts
for two conditions, perform all the steps in EISA (normalize, identify
quantifyable genes, calculate contrasts and their significance)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eisaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/eisaR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/eisaR.html">eisaR</a>
    </li>
    <li>
      <a href="../articles/rna-velocity.html">Feature extraction for RNA velocity</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fmicompbio/eisaR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run Exon-Intron Split Analysis.</h1>
    <small class="dont-index">Source: <a href="https://github.com/fmicompbio/eisaR/blob/HEAD/R/runEISA.R" class="external-link"><code>R/runEISA.R</code></a></small>
    <div class="hidden name"><code>runEISA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Starting from count tables with exonic and intronic counts
for two conditions, perform all the steps in EISA (normalize, identify
quantifyable genes, calculate contrasts and their significance).</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">runEISA</span><span class="op">(</span>
  <span class="va">cntEx</span>,
  <span class="va">cntIn</span>,
  <span class="va">cond</span>,
  method <span class="op">=</span> <span class="cn">NULL</span>,
  modelSamples <span class="op">=</span> <span class="cn">TRUE</span>,
  geneSelection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"filterByExpr"</span>, <span class="st">"none"</span>, <span class="st">"Gaidatzis2015"</span><span class="op">)</span>,
  statFramework <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"QLF"</span>, <span class="st">"LRT"</span><span class="op">)</span>,
  effects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"predFC"</span>, <span class="st">"Gaidatzis2015"</span><span class="op">)</span>,
  pscnt <span class="op">=</span> <span class="fl">2</span>,
  sizeFactor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exon"</span>, <span class="st">"intron"</span>, <span class="st">"individual"</span><span class="op">)</span>,
  recalcNormFactAfterFilt <span class="op">=</span> <span class="cn">TRUE</span>,
  recalcLibSizeAfterFilt <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>

    <div id="ref-sections">
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>cntEx</dt>
<dd><p>Gene by sample <code>matrix</code> with exonic counts, OR a
<code>SummarizedExperiment</code> with two assays named <code>exon</code> and
<code>intron</code>, containing exonic and intronic counts, respectively. If
<code>cntEx</code> is a <code>SummarizedExperiment</code>, <code>cntIn</code> will be
disregarded.</p></dd>
<dt>cntIn</dt>
<dd><p>Gene by sample <code>matrix</code> with intronic counts. Must have the
same structure as <code>cntEx</code> (same number and order of rows and columns)
if <code>cntEx</code> is a matrix. Will be disregarded if <code>cntEx</code> is a
<code>SummarizedExperiment</code>.</p></dd>
<dt>cond</dt>
<dd><p><code>numeric</code>, <code>character</code> or <code>factor</code> with two levels
that groups the samples (columns of <code>cntEx</code> and <code>cntIn</code>) into two
conditions. The contrast will be defined as secondLevel - firstLevel.</p></dd>
<dt>method</dt>
<dd><p>One of <code>NULL</code> (the default) or <code>"Gaidatzis2015"</code>. If
<code>"Gaidatzis2015"</code>, gene filtering, statistical analysis and
calculation of contrasts is performed as described in Gaidatzis et al.
2015, and the statistical analysis is based on <code><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html" class="external-link">glmFit</a></code>
and <code><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html" class="external-link">glmLRT</a></code>. This is done by setting the arguments
<code>modelSamples</code>, <code>geneSelection</code>, <code>effects</code>, <code>pscnt</code>,
<code>statFramework</code>, <code>sizeFactor</code>, <code>recalcNormFactAfterFilt</code>
and <code>recalcLibSizeAfterFilt</code>
to appropriate values (see details), overriding the defaults or any value
passed to these arguments. If <code>NULL</code>, the default values of the arguments
will be used instead (recommended).</p></dd>
<dt>modelSamples</dt>
<dd><p>Whether to include a sample identifier in the design matrix
of the statistical model. If <code>TRUE</code>, potential sample effects
that affect both exonic and intronic counts of that sample will be taken
into account, which could result in higher sensitivity (default: <code>TRUE</code>).</p></dd>
<dt>geneSelection</dt>
<dd><p>Controls how to select quantifyable genes. One of the
following:</p><dl><dt><code>"filterByExpr"</code>: </dt>
<dd><p>(default) First, counts are normalized using
<code><a href="https://rdrr.io/pkg/edgeR/man/calcNormFactors.html" class="external-link">calcNormFactors</a></code>, treating intronic and exonic counts
as individual samples. Then, <code><a href="https://rdrr.io/pkg/edgeR/man/filterByExpr.html" class="external-link">filterByExpr</a></code> is used
with default parameters to select quantifyable genes.</p></dd>

<dt><code>"none"</code>: </dt>
<dd><p>This will use all the genes provided in the count
tables, assuming that an appropriate selection of quantifyable genes has
already been done.</p></dd>

<dt><code>"Gaidatzis2015"</code>: </dt>
<dd><p>First, intronic and exonic counts are
linearly scaled to the mean library size (estimated as the sum of all
intronic or exonic counts, respectively). Then, quantifyable genes are
selected as the genes with counts <code>x</code> that fulfill
<code>log2(x + 8) &gt; 5</code> in both exons and introns.</p></dd>


</dl></dd>
<dt>statFramework</dt>
<dd><p>Selects the framework within <code>edgeR</code> that is used
for the statistical analysis. One of:</p><dl><dt><code>"QLF"</code>: </dt>
<dd><p>(default) Quasi-likelihood F-test using
<code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFTest.html" class="external-link">glmQLFit</a></code> and <code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFTest.html" class="external-link">glmQLFTest</a></code>. This
framework is highly recommended as it gives stricter error rate control
by accounting for the uncertainty in dispersion estimation.</p></dd>

<dt><code>"LRT"</code>: </dt>
<dd><p>Likelihood ratio test using <code><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html" class="external-link">glmFit</a></code>
and <code><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html" class="external-link">glmLRT</a></code></p></dd>
.

</dl></dd>
<dt>effects</dt>
<dd><p>How the effects (contrasts or log2 fold-changes) are calculated.
One of:</p><dl><dt><code>"predFC"</code>: </dt>
<dd><p>(default) Fold-changes are calculated using
the fitted model with <code><a href="https://rdrr.io/pkg/edgeR/man/predFC.html" class="external-link">predFC</a></code> with
<code>prior.count = pscnt</code>. Please note that if a sample factor is
included in the model (<code>modelSamples=TRUE</code>), effects cannot be
obtained from that model. In that case, effects are obtained from a
simpler model without sample effects.</p></dd>

<dt><code>"Gaidatzis2015"</code>: </dt>
<dd><p>Fold-changes are calculated using the
formula <code>log2((x + pscnt)/(y + pscnt))</code>. If <code>pscnt</code> is not
set to 8, <code>runEISA</code> will warn that this deviates from the method
used in Gaidatzis et al., 2015.</p></dd>


</dl></dd>
<dt>pscnt</dt>
<dd><p><code>numeric(1)</code> with pseudocount to add to read counts
(default: 2). For <code>method = "Gaidatzis2015"</code>, it is set to 8.
It is added to scaled read counts used in <code>geneSelection = "Gaidatzis2015"</code>
and <code>effects = "Gaidatzis2015"</code>, or else used in <code>cpm(..., prior.count = pscnt)</code>
and <code>predFC(..., prior.count = pscnt)</code>.</p></dd>
<dt>sizeFactor</dt>
<dd><p>How the size factors are calculated in the analysis.
If 'exon' (default), the exon-derived size factors are used also for the
columns corresponding to intronic counts. If 'intron', the intron-derived
size factors are used also for the columns corresponding to exonic
counts. If 'individual', column-wise size factors are calculated.</p></dd>
<dt>recalcNormFactAfterFilt</dt>
<dd><p>Logical, indicating whether normalization
factors should be recalculated after filtering out lowly
expressed genes.</p></dd>
<dt>recalcLibSizeAfterFilt</dt>
<dd><p>Logical, indicating whether library
sizes should be recalculated after filtering out lowly
expressed genes.</p></dd>
<dt>...</dt>
<dd><p>additional arguments passed to the <code><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html" class="external-link">DGEList</a></code>
constructor, such as <code>lib.size</code> or <code>genes</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a <code>list</code> with elements</p><dl><dt>fracIn</dt>
<dd><p>fraction intronic counts in each sample</p></dd>

<dt>contrastName</dt>
<dd><p>contrast name</p></dd>

<dt>contrasts</dt>
<dd><p>contrast matrix for quantifyable genes, with average log2
fold-changes in exons (<code>Dex</code>), in introns (<code>Din</code>), and average
difference between log2 fold-changes in exons and introns (<code>Dex.Din</code>)</p></dd>

<dt>DGEList</dt>
<dd><p><code><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html" class="external-link">DGEList</a></code> object used in model fitting</p></dd>

<dt>tab.ExIn</dt>
<dd><p>statisical results for differential changes between exonic
and intronic contrast, an indication for post-transcriptional regulation.</p></dd>

<dt>contr.ExIn</dt>
<dd><p>contrast vector used for testing the difference between
exonic and intronic contrast (results in <code>tab.ExIn</code>)</p></dd>

<dt>designMatrix</dt>
<dd><p>design matrix used for testing the difference between
exonic and intronic contrast (results in <code>tab.ExIn</code>)</p></dd>

<dt>params</dt>
<dd><p>a <code>list</code> with parameter values used to run EISA</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Setting <code>method = "Gaidatzis2015"</code> has precedence over other
argument values and corresponds to setting:
<code>modelSamples = FALSE, geneSelection = "Gaidatzis2015",
  statFramework = "LRT", effects = "Gaidatzis2015", pscnt = 8, 
  sizeFactor = "individual", recalcNormFactAfterFilt = TRUE, 
  recalcLibSizeAfterFilt = FALSE</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Analysis of intronic and exonic reads in RNA-seq data characterizes
transcriptional and post-transcriptional regulation.
Dimos Gaidatzis, Lukas Burger, Maria Florescu and Michael B. Stadler
Nature Biotechnology, 2015 Jul;33(7):722-9. doi: 10.1038/nbt.3269.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html" class="external-link">DGEList</a></code> for <code>DGEList</code> object construction,
<code><a href="https://rdrr.io/pkg/edgeR/man/calcNormFactors.html" class="external-link">calcNormFactors</a></code> for normalization,
<code><a href="https://rdrr.io/pkg/edgeR/man/filterByExpr.html" class="external-link">filterByExpr</a></code> for gene selection,
<code><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html" class="external-link">glmFit</a></code> and <code><a href="https://rdrr.io/pkg/edgeR/man/glmQLFTest.html" class="external-link">glmQLFit</a></code> for statistical
analysis.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Michael Stadler</p>
    </div>
    </div>

    <div id="examples">
    <h2>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">cntEx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Fig3abc_GSE33252_rawcounts_exonic.rds"</span>,</span>
<span class="r-in">                             package <span class="op">=</span> <span class="st">"eisaR"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span class="r-in"><span class="va">cntIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Fig3abc_GSE33252_rawcounts_intronic.rds"</span>,</span>
<span class="r-in">                             package <span class="op">=</span> <span class="st">"eisaR"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span class="r-in"><span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ES"</span>,<span class="st">"ES"</span>,<span class="st">"TN"</span>,<span class="st">"TN"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">runEISA</span><span class="op">(</span><span class="va">cntEx</span>, <span class="va">cntIn</span>, <span class="va">cond</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> filtering quantifyable genes...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> keeping 11759 from 20288 (58%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fitting statistical model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> calculating log-fold changes...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-in"><span class="fu"><a href="plotEISA.html">plotEISA</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> identified 114 genes to highlight</span>
<span class="r-plt"><img src="runEISA-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/mbstadler" class="external-link">Michael Stadler</a>, Dimos Gaidatzis, <a href="https://github.com/LukasBurger" class="external-link">Lukas Burger</a>, <a href="https://csoneson.github.io" class="external-link">Charlotte Soneson</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

